<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produtos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    

    <div class="container-fluid">

        <div class="row">
            <!-- SIDEBAR -->
            <div id="container-sidebar" class="col-md-6 col-lg-2 m-0 p-0"></div>

            <!-- NAVBAR -->
            <div class="col-lg-10 col-12 bg-light">
                <div id="container-navbar">

                </div>


                <div class="row mt-3 justify-content-center">
                    <div class="col-lg-10 col-12">
        
                        <div class="card">
                            <div class="card-body">
                                <form class="CadProd" method="POST">
                                    <h4 class="card-title mb-3">Cadastrar Produto</h4>
                                    <h5>Nome</h5>
                                    <input type="text" placeholder="Informe o nome do Produto" class="nome w-50" required>
                                    <h5 class="mt-3">Descrição</h5>
                                    <textarea placeholder="Informe uma Descrição ao seu Produto" class="Descricao w-50" rows="5" required></textarea>
                                    <h5 class="mt-3">Preço</h5>
                                    <input type="number" placeholder="R$xx,xx"  step="0.01" class="preco w-50" required>
                                    <h5 class="mt-3"> Imagem</h5>
                                    <input type="file" accept="image/*" class="img" required>
                                    <h5 class="mt-3">Cadastrar</h5>
                                    <button type="submit" class="Submit Botao-FODA btn btn-primary">Cadastrar</button>
                                </form>
                            </div>
        
        
                        </div>
        
        
        
                    </div>
                </div>

            </div>


            


                



            <!-- <img crossorigin="anonymous" src="maclovin.jpeg" alt=""> -->
            <!-- <canvas class="myCanvas"></canvas> -->



        </div>



    </div>






    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/app.js"></script>
    <script>


        




        const nomeProd = document.querySelector('.nome');
        const DescricaoProd = document.querySelector('.Descricao');
        const precoProd = document.querySelector('.preco');
        const imgProd = document.querySelector('.img');


        // console.log(imgProd)

        let produsto = JSON.parse(localStorage.getItem('produtos')) || [];
        produsto = produsto.filter(n=>n);
        console.log(produsto);
        localStorage.setItem('produtos',JSON.stringify(produsto));
        
        document.querySelector('.CadProd').addEventListener('submit',(e)=>{
            e.preventDefault();
        
            console.log('teste')
            let leitor = new FileReader();
            leitor.readAsDataURL(imgProd.files[0]);
            leitor.onload = ()=>{
                let produtos = JSON.parse(localStorage.getItem("produtos")) || [];

                let novoProd = {
                    nome: nomeProd.value,
                    descricao: DescricaoProd.value,
                    preco: precoProd.value,
                    imagem: leitor.result 
                };
                produtos.push(novoProd);
                localStorage.setItem('produtos',JSON.stringify(produtos))
                nomeProd.value = '';
                DescricaoProd.value = '';
                precoProd.value = '';
                // imgProd.files[0] = null;não funciona:D
                produtos = null;
            };
                
            
        })
        console.log();


        // let img = document.createElement('img');
        // img.style.display = 'none';
        // img.crossOrigin = 'anonymous';
        // img.src = 'https://avatars.githubusercontent.com/u/134729228?v=4';
        // let canva = document.createElement('canvas');
        // canva.height = img.height;
        // canva.width = img.width;
        // let ctx = canva.getContext('2d');
        // ctx.drawImage(img,0,0)
        // canva.style.display = 'none';
        // console.log(canva.toDataURL());
        // let img = document.querySelector('img');
        // // img.style.display = 'none';
        // console.log(img);
        // let imageTeste = img.currentSrc;
        // console.log(imageTeste);
        // let canva = document.querySelector('canvas');
        // canva.width = img.width;
        // canva.height = img.height;
        // console.log(canva);
        // let ctx = canva.getContext('2d');
        // ctx.drawImage(img,0,0);
        // console.log(canva);
        // // localStorage.setItem('img',imageTeste);
        // console.log(canva.toDataURL());
        // // console.log(imageTeste)

    </script>
</body>
</html>